\begin{code}%
\>\AgdaComment{-- this wraps around the natural numbers because we will end up having too many Instances of the same type (ℕ)}\<%
\\
\>\AgdaComment{-- and we will have to specify them explicitly. This helps for readability.}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Nat}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary.PropositionalEquality}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{≡-Reasoning}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{numbers}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{AlgebraStructures}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Level} \AgdaKeyword{using} \AgdaSymbol{(}\AgdaPostulate{Level}\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Bool}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Nat}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Maybe}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Induction}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Induction.WellFounded} \AgdaSymbol{as} \AgdaModule{WF}\<%
\\
\>\AgdaKeyword{module} \AgdaModule{SizeW} \AgdaKeyword{where}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{data} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaBound{a} \<[26]%
\>[26]\AgdaKeyword{where}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{size} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{(}\AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{ε} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a} \AgdaSymbol{:} \AgdaPostulate{Level}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{ε} \AgdaSymbol{=} \AgdaInductiveConstructor{size} \AgdaNumber{0}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{\_∙\_} \AgdaSymbol{:} \<[9]%
\>[9]\AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{size} \AgdaBound{n} \AgdaFunction{∙} \AgdaInductiveConstructor{size} \AgdaBound{m} \AgdaSymbol{=} \AgdaInductiveConstructor{size} \AgdaSymbol{(}\AgdaBound{n} \AgdaPrimitive{+} \AgdaBound{m}\AgdaSymbol{)}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaComment{-- proving the monoid properties of this datatype}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{import} \AgdaModule{numbers}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{∙-comm} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\})→} \AgdaSymbol{(}\AgdaBound{y} \AgdaSymbol{:} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\})} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{x} \AgdaFunction{∙} \AgdaBound{y} \AgdaDatatype{≡} \AgdaBound{y} \AgdaFunction{∙} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{∙-comm} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{m}\AgdaSymbol{)} \AgdaKeyword{rewrite} \AgdaFunction{+comm} \AgdaBound{n} \AgdaBound{m} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{\_<ˢ\_} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{size} \AgdaBound{n} \AgdaFunction{<ˢ} \AgdaInductiveConstructor{size} \AgdaBound{m} \AgdaSymbol{=} \AgdaBound{n} \AgdaFunction{<-nat} \AgdaBound{m}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{\_<=ˢ\_} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{size} \AgdaBound{n} \AgdaFunction{<=ˢ} \AgdaInductiveConstructor{size} \AgdaBound{m} \AgdaSymbol{=} \AgdaBound{n} \AgdaFunction{<=nat} \AgdaBound{m}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{\_==ˢ\_} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{Bool}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{size} \AgdaBound{n} \AgdaFunction{==ˢ} \AgdaInductiveConstructor{size} \AgdaBound{m} \AgdaSymbol{=} \AgdaBound{n} \AgdaFunction{==} \AgdaBound{m}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{data} \AgdaDatatype{\_<ᵗ\_} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{:} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{a} \AgdaKeyword{where}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaInductiveConstructor{lt} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{n} \AgdaFunction{<} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaInductiveConstructor{size} \AgdaBound{n} \AgdaDatatype{<ᵗ} \AgdaInductiveConstructor{size} \AgdaBound{m}\<%
\\
%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{unit-step} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a} \AgdaSymbol{:} \AgdaPostulate{Level}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{\{}\AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaDatatype{<ᵗ} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaNumber{1} \<[65]%
\>[65]\AgdaFunction{∙} \AgdaInductiveConstructor{size} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{unit-step} \AgdaSymbol{\{\_\}\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaInductiveConstructor{lt} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaSymbol{(}\AgdaFunction{numbers.≤-refl} \AgdaBound{n}\AgdaSymbol{))}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{∙ε} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{s} \AgdaSymbol{:} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\})} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{s} \AgdaFunction{∙} \AgdaFunction{ε} \AgdaDatatype{≡} \AgdaBound{s}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{∙ε} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{cong} \AgdaInductiveConstructor{size} \AgdaSymbol{(}\AgdaFunction{+0} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{ε∙} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{s} \AgdaSymbol{:} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\})} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaFunction{ε} \AgdaFunction{∙} \AgdaBound{s} \AgdaDatatype{≡} \AgdaBound{s}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{ε∙} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{∙-assoc} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{s} \AgdaBound{p} \AgdaBound{q} \AgdaSymbol{:} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\})} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{s} \AgdaFunction{∙} \AgdaSymbol{(}\AgdaBound{p} \AgdaFunction{∙} \AgdaBound{q}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaSymbol{(}\AgdaBound{s} \AgdaFunction{∙} \AgdaBound{p}\AgdaSymbol{)} \AgdaFunction{∙} \AgdaBound{q}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{∙-assoc} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{o}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{cong} \AgdaInductiveConstructor{size} \AgdaSymbol{(}\AgdaFunction{+assoc} \AgdaBound{n} \AgdaBound{m} \AgdaBound{o}\AgdaSymbol{)}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{instance} \AgdaFunction{size-monoid} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaRecord{Monoid} \AgdaSymbol{(}\AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\})}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{size-monoid} \AgdaSymbol{=} \AgdaInductiveConstructor{monoid} \AgdaFunction{ε} \AgdaFunction{\_∙\_} \AgdaFunction{ε∙} \AgdaFunction{∙ε} \AgdaFunction{∙-assoc} \AgdaDatatype{\_<ᵗ\_}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{getSize} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{ℕ}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{getSize} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaBound{n}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{module} \AgdaModule{less-than} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaComment{-- proofs required for termination checking}\<%
\\
%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaKeyword{data} \AgdaDatatype{\_<<\_} \AgdaSymbol{:} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{a} \AgdaKeyword{where}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaInductiveConstructor{cmp} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaBound{n} \AgdaBound{m} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{n} \AgdaFunction{<} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{n}\AgdaSymbol{)} \AgdaDatatype{<<} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{m}\AgdaSymbol{)}\<%
\\
%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaBound{n} \AgdaBound{m} \AgdaBound{p} \AgdaSymbol{→} \AgdaBound{n} \AgdaFunction{<} \AgdaBound{m} \AgdaSymbol{→} \AgdaBound{m} \AgdaFunction{<} \AgdaBound{p} \AgdaSymbol{→} \AgdaBound{n} \AgdaFunction{<} \AgdaBound{p}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans} \AgdaInductiveConstructor{zero} \AgdaInductiveConstructor{zero} \AgdaBound{p} \AgdaBound{p1} \AgdaBound{p2} \AgdaSymbol{=} \AgdaBound{p2}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaBound{p1}\AgdaSymbol{)} \AgdaSymbol{()}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{p}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaBound{p1}\AgdaSymbol{)} \AgdaBound{p2} \AgdaSymbol{=} \AgdaInductiveConstructor{s≤s} \AgdaInductiveConstructor{z≤n}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaBound{p} \AgdaSymbol{()}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaBound{p1} \AgdaSymbol{()}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{p}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaBound{p1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaBound{p2}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{s≤s} \AgdaSymbol{(}\AgdaFunction{<-trans} \AgdaBound{n} \AgdaBound{m} \AgdaBound{p} \AgdaBound{p1} \AgdaBound{p2}\AgdaSymbol{)}\<%
\\
%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans2} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaBound{n} \AgdaBound{m} \AgdaBound{p} \AgdaSymbol{→} \AgdaBound{n} \AgdaFunction{<} \AgdaBound{m} \AgdaSymbol{→} \AgdaBound{m} \AgdaDatatype{≤} \AgdaBound{p} \AgdaSymbol{→} \AgdaBound{n} \AgdaFunction{<} \AgdaBound{p}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans2} \AgdaInductiveConstructor{zero} \AgdaInductiveConstructor{zero} \AgdaBound{p} \AgdaSymbol{()} \AgdaBound{p2}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans2} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaBound{p1} \AgdaSymbol{()}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans2} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{p}\AgdaSymbol{)} \AgdaBound{p1} \AgdaBound{p2} \AgdaSymbol{=} \AgdaInductiveConstructor{s≤s} \AgdaInductiveConstructor{z≤n}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans2} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaBound{p} \AgdaSymbol{()} \AgdaBound{p2}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans2} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaBound{p1} \AgdaSymbol{()}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<-trans2} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{p}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaBound{p1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaBound{p2}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{s≤s} \AgdaSymbol{(}\AgdaFunction{<-trans2} \AgdaBound{n} \AgdaBound{m} \AgdaBound{p} \AgdaBound{p1} \AgdaBound{p2}\AgdaSymbol{)}\<%
\\
%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{≤-to-<} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaBound{n} \AgdaBound{m} \AgdaSymbol{→} \AgdaBound{n} \AgdaDatatype{≤} \AgdaBound{m} \AgdaSymbol{→} \AgdaBound{n} \AgdaFunction{<} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{≤-to-<} \AgdaInductiveConstructor{zero} \AgdaInductiveConstructor{zero} \AgdaSymbol{=} \AgdaInductiveConstructor{s≤s}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{≤-to-<} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{s≤s}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{≤-to-<} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaSymbol{()}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{≤-to-<} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{s≤s}\<%
\\
%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-trans} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{(}\AgdaBound{σ} \AgdaBound{τ} \AgdaBound{μ} \AgdaSymbol{:} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\})} \AgdaSymbol{→} \AgdaBound{σ} \AgdaDatatype{<<} \AgdaBound{τ} \AgdaSymbol{→} \AgdaBound{τ} \AgdaDatatype{<<} \AgdaBound{μ} \AgdaSymbol{→} \AgdaBound{σ} \AgdaDatatype{<<} \AgdaBound{μ}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-trans} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{n₁}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{n₂}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{cmp} \AgdaSymbol{.}\AgdaBound{n} \AgdaSymbol{.}\AgdaBound{n₁} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{cmp} \AgdaSymbol{.}\AgdaBound{n₁} \AgdaSymbol{.}\AgdaBound{n₂} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{cmp} \AgdaBound{n} \AgdaBound{n₂} \AgdaSymbol{(}\AgdaFunction{<-trans} \AgdaBound{n} \AgdaBound{n₁} \AgdaBound{n₂} \AgdaBound{x} \AgdaBound{y}\AgdaSymbol{)}\<%
\\
%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-trans2} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{σ} \AgdaSymbol{:} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\})} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{n} \AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{σ} \AgdaDatatype{<<} \AgdaInductiveConstructor{size} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{))} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m} \AgdaDatatype{≤} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{σ} \AgdaDatatype{<<} \AgdaInductiveConstructor{size} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-trans2} \AgdaBound{σ} \AgdaInductiveConstructor{zero} \AgdaInductiveConstructor{zero} \AgdaBound{p1} \AgdaSymbol{()}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-trans2} \AgdaBound{σ} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaBound{p1} \AgdaSymbol{()}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-trans2} \AgdaSymbol{.(}\AgdaInductiveConstructor{size} \AgdaBound{s}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaInductiveConstructor{cmp} \AgdaBound{s} \AgdaSymbol{.}\AgdaNumber{1} \AgdaBound{x}\AgdaSymbol{)} \AgdaBound{p2} \AgdaSymbol{=} \AgdaInductiveConstructor{cmp} \AgdaBound{s} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{<-trans2} \AgdaBound{s} \AgdaNumber{1} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaBound{x} \AgdaBound{p2}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-trans2} \AgdaSymbol{.(}\AgdaInductiveConstructor{size} \AgdaBound{s}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{cmp} \AgdaBound{s} \AgdaSymbol{.(}\AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{))} \AgdaBound{x}\AgdaSymbol{)} \AgdaBound{p2} \AgdaSymbol{=} \AgdaInductiveConstructor{cmp} \AgdaBound{s} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{<-trans2} \AgdaBound{s} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaBound{x} \AgdaBound{p2}\AgdaSymbol{)}\<%
\\
%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-trans3} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{σ} \AgdaSymbol{:} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\})} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{m} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{σ} \AgdaDatatype{<<} \AgdaInductiveConstructor{size} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{m} \AgdaDatatype{≤} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{σ} \AgdaDatatype{<<} \AgdaInductiveConstructor{size} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-trans3} \AgdaSymbol{.(}\AgdaInductiveConstructor{size} \AgdaBound{s}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaBound{n} \AgdaSymbol{(}\AgdaInductiveConstructor{cmp} \AgdaBound{s} \AgdaSymbol{.}\AgdaNumber{0} \AgdaSymbol{())} \AgdaBound{p2}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-trans3} \AgdaBound{σ} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaBound{p1} \AgdaSymbol{()}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-trans3} \AgdaSymbol{.(}\AgdaInductiveConstructor{size} \AgdaBound{s}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{cmp} \AgdaBound{s} \AgdaSymbol{.(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaBound{x}\AgdaSymbol{)} \AgdaBound{p2} \AgdaSymbol{=} \AgdaInductiveConstructor{cmp} \AgdaBound{s} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{<-trans2} \AgdaBound{s} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaBound{x} \AgdaBound{p2}\AgdaSymbol{)}\<%
\\
%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{≤-axiom} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaBound{n} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{n} \AgdaDatatype{≤} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{≤-axiom} \AgdaInductiveConstructor{zero} \AgdaSymbol{=} \AgdaInductiveConstructor{z≤n}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{≤-axiom} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{s≤s} \AgdaSymbol{(}\AgdaFunction{≤-axiom} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-axiom0} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaBound{n} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{n}\AgdaSymbol{)} \AgdaDatatype{<<} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-axiom0} \AgdaInductiveConstructor{zero} \AgdaSymbol{=} \AgdaInductiveConstructor{cmp} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaInductiveConstructor{zero}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaInductiveConstructor{z≤n}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-axiom0} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{cmp} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaSymbol{(}\AgdaFunction{≤-axiom} \AgdaBound{n}\AgdaSymbol{)))}\<%
\\
%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{one-step-lemma} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{(}\AgdaBound{s} \AgdaSymbol{:} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\})} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{s} \AgdaDatatype{<<} \AgdaSymbol{((}\AgdaInductiveConstructor{size} \AgdaNumber{1}\AgdaSymbol{)} \AgdaFunction{∙} \AgdaBound{s}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{one-step-lemma} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{<<-axiom0} \AgdaBound{n}\<%
\\
%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-Rec} \AgdaSymbol{:} \AgdaFunction{RecStruct} \AgdaSymbol{(}\AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\})} \AgdaBound{a} \AgdaBound{a}\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{<<-Rec} \AgdaSymbol{=} \AgdaFunction{WfRec} \AgdaDatatype{\_<<\_}\<%
\\
%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaKeyword{mutual}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{<<-WF} \AgdaSymbol{:} \AgdaFunction{Well-founded} \AgdaSymbol{(}\AgdaDatatype{\_<<\_} \AgdaSymbol{)}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{<<-WF} \AgdaBound{n} \AgdaSymbol{=} \AgdaInductiveConstructor{acc} \AgdaSymbol{(}\AgdaFunction{<<-WF'} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{<<-WF'} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{SizeW} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\})} \AgdaSymbol{→} \AgdaFunction{<<-Rec} \AgdaSymbol{(}\AgdaDatatype{Acc} \AgdaDatatype{\_<<\_}\AgdaSymbol{)} \AgdaBound{n}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{<<-WF'} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaInductiveConstructor{zero}\AgdaSymbol{)} \AgdaSymbol{.(}\AgdaInductiveConstructor{size} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{cmp} \AgdaBound{m} \AgdaSymbol{.}\AgdaNumber{0} \AgdaSymbol{())}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaFunction{<<-WF'} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{))} \AgdaSymbol{.(}\AgdaInductiveConstructor{size} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{cmp} \AgdaBound{m} \AgdaSymbol{.(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{s≤s} \AgdaBound{x}\AgdaSymbol{))} \AgdaSymbol{=} \AgdaInductiveConstructor{acc} \AgdaSymbol{(λ} \AgdaBound{o} \AgdaBound{o<m} \AgdaSymbol{→} \AgdaFunction{<<-WF'} \AgdaSymbol{(}\AgdaInductiveConstructor{size} \AgdaBound{n}\AgdaSymbol{)} \AgdaBound{o} \AgdaSymbol{(}\AgdaFunction{<<-trans3} \AgdaBound{o} \AgdaBound{m} \AgdaBound{n} \AgdaBound{o<m} \AgdaBound{x}\AgdaSymbol{))}\<%
\end{code}
