    % Hack to get the amsthm package working.
    % https://tex.stackexchange.com/questions/130491/xelatex-error-paragraph-ended-before-tempa-was-complete
    \let\AgdaOpenBracket\[\let\AgdaCloseBracket\]
    \RequirePackage{fontspec}
    \let\[\AgdaOpenBracket\let\]\AgdaCloseBracket
    \RequirePackage{unicode-math}

    \tracinglostchars=2 % If the font is missing some symbol, then say
                        % so in the compilation output.
    \setmainfont
      [ Ligatures      = TeX
      , BoldItalicFont = xits-bolditalic.otf
      , BoldFont       = xits-bold.otf
      , ItalicFont     = xits-italic.otf
      ]
      {xits-regular.otf}

    \setmathfont{xits-math.otf}
    \setmonofont[Mapping=tex-text]{FreeMono.otf}

    % Make mathcal and mathscr appear as different.
    % https://tex.stackexchange.com/questions/120065/xetex-what-happened-to-mathcal-and-mathscr
    \setmathfont[range={\mathcal,\mathbfcal},StylisticSet=1]{xits-math.otf}
    \setmathfont[range=\mathscr]{xits-math.otf}

    \providecommand{\DeclareUnicodeCharacter}[2]{\relax}

